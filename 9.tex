\chapter{内积空间}

%——————————————————————————————————%

\section{内积空间}

\begin{definition}
    设 $V$ 是实数域上的线性空间，若对 $V$ 中任意一组有序向量 $\{\bm{\alpha}, \bm{\beta}\}$，都唯一地对应一个实数，记为 $\langle \bm{\alpha}, \bm{\beta} \rangle$，满足下列条件：
    \begin{enumerate}
        \item $\langle \bm{\beta}, \bm{\alpha} \rangle = \langle \bm{\alpha}, \bm{\beta} \rangle$；
        \item $\langle \bm{\alpha} + \bm{\beta}, \bm{\gamma} \rangle = \langle \bm{\alpha}, \bm{\gamma} \rangle + \langle \bm{\beta}, \bm{\gamma} \rangle$；
        \item $\langle c\bm{\alpha}, \bm{\beta} \rangle = c\langle \bm{\alpha}, \bm{\beta} \rangle$，其中 $c$ 为任一实数；
        \item $\langle \bm{\alpha}, \bm{\alpha} \rangle \geqslant 0$ 且等号成立当且仅当 $\bm{\alpha} = \bm{0}$。
    \end{enumerate}
    则称在 $V$ 上定义了一个内积，实数 $\langle \bm{\alpha}, \bm{\beta} \rangle$ 称为 $\bm{\alpha}$ 与 $\bm{\beta}$ 的内积。线性空间 $V$ 称为实内积空间。有限维实内积空间称为 Euclid 空间，简称欧氏空间。
\end{definition}

\begin{definition}
    设 $V$ 是复数域上的线性空间，若对 $V$ 中任意一组有序向量 $\{\bm{\alpha}, \bm{\beta}\}$，都唯一地对应一个复数，记为 $\langle \bm{\alpha}, \bm{\beta} \rangle$，满足下列条件：
    \begin{enumerate}
        \item $\langle \bm{\beta}, \bm{\alpha} \rangle = \overline{\langle \bm{\alpha}, \bm{\beta} \rangle}$；
        \item $\langle \bm{\alpha} + \bm{\beta}, \bm{\gamma} \rangle = \langle \bm{\alpha}, \bm{\gamma} \rangle + \langle \bm{\beta}, \bm{\gamma} \rangle$；
        \item $\langle c\bm{\alpha}, \bm{\beta} \rangle = c\langle \bm{\alpha}, \bm{\beta} \rangle$，其中 $c$ 为任一复数；
        \item $\langle \bm{\alpha}, \bm{\alpha} \rangle \geqslant 0$ 且等号成立当且仅当 $\bm{\alpha} = \bm{0}$。
    \end{enumerate}
    则称在 $V$ 上定义了一个内积，复数 $\langle \bm{\alpha}, \bm{\beta} \rangle$ 称为 $\bm{\alpha}$ 与 $\bm{\beta}$ 的内积。线性空间 $V$ 称为复内积空间。有限维复内积空间称为酉空间。
\end{definition}

\begin{remark}
    实内积空间和复内积空间统称为内积空间。
\end{remark}

\begin{remark}
    由 $(1)$ 和 $(3)$，有 $\langle \bm{\alpha}, c\bm{\beta} \rangle = \overline{c}\langle \bm{\alpha}, \bm{\beta} \rangle$。
\end{remark}

\begin{definition}
    设 $\mathbb{R}_n$ 是 $n$ 维实列向量空间，$\bm{\alpha} = (x_1, x_2, \ldots, x_n)^{\mathrm{T}}, \bm{\beta} = (y_1, y_2, \ldots, y_n)^{\mathrm{T}}$，定义
    \[
        \langle \bm{\alpha}, \bm{\beta} \rangle = x_{1}y_{1} + x_{2}y_{2} + \cdots + x_{n}y_{n}
    \]
    则 $\mathbb{R}_n$ 成为一个欧式空间，上述内积称为 $\mathbb{R}_n$ 的标准内积。
\end{definition}

\begin{definition}
    设 $\mathbb{C}_n$ 是 $n$ 维复列向量空间，$\bm{\alpha} = (x_1, x_2, \ldots, x_n)^{\mathrm{T}}, \bm{\beta} = (y_1, y_2, \ldots, y_n)^{\mathrm{T}}$，定义
    \[
        \langle \bm{\alpha}, \bm{\beta} \rangle = x_{1}\overline{y}_{1} + x_{2}\overline{y}_{2} + \cdots + x_{n}\overline{y}_{n}
    \]
    则 $\mathbb{C}_n$ 成为一个酉空间，上述内积称为 $\mathbb{C}_n$ 的标准内积。
\end{definition}

\begin{proposition}
    设 $V$ 是 $n$ 维实列向量空间，$\bm{G}$ 是 $n$ 阶正定实对称阵，对 $\bm{\alpha}, \bm{\beta} \in V$，定义
    \[
        \langle \bm{\alpha}, \bm{\beta} \rangle = \bm{\alpha}^{\mathrm{T}}\bm{G\beta}
    \]
    则 $V$ 成为一个欧式空间。当 $\bm{G} = \bm{I}_n$，即 $\bm{G}$ 为单位阵时，$V$ 上的内积就是标准内积。

    实列向量空间的标准内积用矩阵乘法可表示为
    \[
        \langle \bm{\alpha}, \bm{\beta} \rangle = \bm{\alpha}^{\mathrm{T}}\bm{\beta}
    \]

    实行向量空间的标准内积用矩阵乘法可表示为
    \[
        \langle \bm{\alpha}, \bm{\beta} \rangle = \bm{\alpha}\bm{\beta}^{\mathrm{T}}
    \]
\end{proposition}

\begin{proposition}
    设 $U$ 是 $n$ 维复列向量空间，$\bm{H}$ 是 $n$ 阶正定 Hermite 阵，对 $\bm{\alpha}, \bm{\beta} \in U$，定义
    \[
        \langle \bm{\alpha}, \bm{\beta} \rangle = \bm{\alpha}^{\mathrm{T}}\bm{H}\overline{\bm{\beta}}
    \]
    则 $U$ 成为一个酉空间。当 $\bm{H} = \bm{I}_n$，即 $\bm{H}$ 为单位阵时，$U$ 上的内积就是标准内积。

    复列向量空间的标准内积用矩阵乘法可表示为
    \[
        \langle \bm{\alpha}, \bm{\beta} \rangle = \bm{\alpha}^{\mathrm{T}}\overline{\bm{\beta}}
    \]

    复行向量空间的标准内积用矩阵乘法可表示为
    \[
        \langle \bm{\alpha}, \bm{\beta} \rangle = \bm{\alpha}\overline{\bm{\beta}}^{\mathrm{T}}
    \]
\end{proposition}

\begin{definition}
    设 $V$ 是内积空间，$\bm{\alpha}$ 是 $V$ 中的向量，定义 $\bm{\alpha}$ 的长度（或称范数）为
    \[
        \Vert \bm{\alpha} \Vert = \sqrt{\langle \bm{\alpha}, \bm{\alpha} \rangle}
    \]
    即实数 $\langle \bm{\alpha}, \bm{\alpha} \rangle$ 的算术平方根。
\end{definition}

\begin{remark}
    根据范数的定义，$\Vert \bm{\alpha} \Vert = 0$ 当且仅当 $\bm{\alpha} = \bm{0}$。
\end{remark}

\begin{remark}
    当 $V = \mathbb{R}^n$ 且内积为标准内积时，若 $\bm{\alpha} = (x_1, x_2, \ldots, x_n)$，则
    \[
        \Vert \bm{\alpha} \Vert = \sqrt{x_{1}^{2} + x_{2}^{2} + \cdots + x_{n}^{2}}
    \]
\end{remark}

\begin{remark}
    设 $\bm{\alpha}, \bm{\beta} \in V$，则 $\bm{\alpha}$ 与 $\bm{\beta}$ 的距离定义为
    \[
        d(\bm{\alpha}, \bm{\beta}) = \Vert \bm{\alpha} - \bm{\beta} \Vert
    \]
    显然 $d(\bm{\alpha}, \bm{\beta}) = d(\bm{\beta}, \bm{\alpha})$。
\end{remark}

\begin{theorem}
    设 $V$ 是内积空间，$\bm{\alpha}, \bm{\beta} \in V$，$c$ 是任一常数，则
    \begin{enumerate}
        \item $\Vert c \bm{\alpha} \Vert = \vert c \vert \cdot \Vert \bm{\alpha} \Vert $；
        \item $\vert \langle \bm{\alpha}, \bm{\beta} \rangle \vert \leqslant \Vert \bm{\alpha} \Vert \cdot \Vert \bm{\beta} \Vert $；
        \item $\Vert \bm{\alpha} + \bm{\beta} \Vert \leqslant \Vert \bm{\alpha} \Vert + \Vert \bm{\beta} \Vert $。
    \end{enumerate}
\end{theorem}

\begin{remark}
    我们将 $(2)$ 称为 Cauchy-Schuwarz 不等式，$(3)$ 称为三角形不等式。
\end{remark}

\begin{definition}
    当 $V$ 是实内积空间时，定义非零向量 $\bm{\alpha}, \bm{\beta}$ 的夹角 $\theta$ 的余弦为
    \[
        \cos \theta = \frac{\langle \bm{\alpha}, \bm{\beta} \rangle}{\Vert \bm{\alpha} \Vert \cdot \Vert \bm{\beta} \Vert}
    \]
    当 $V$ 是复内积空间时，定义非零向量 $\bm{\alpha}, \bm{\beta}$ 的夹角 $\theta$ 的余弦为
    \[
        \cos \theta = \frac{\vert \langle \bm{\alpha}, \bm{\beta} \rangle \vert}{\Vert \bm{\alpha} \Vert \cdot \Vert \bm{\beta} \Vert}
    \]
    若内积空间中的两个向量 $\bm{\alpha}, \bm{\beta}$ 满足 $\langle \bm{\alpha}, \bm{\beta} \rangle = 0$，则称 $\bm{\alpha}$ 与 $\bm{\beta}$ 垂直或正交，记为 $\bm{\alpha} \perp \bm{\beta}$。

    正交的性质：
    \begin{enumerate}
        \item 零向量与任何向量都正交；
        \item 若 $\bm{\alpha}$ 与 $\bm{\beta}$ 正交，则 $\bm{\beta}$ 也与 $\bm{\alpha}$ 正交；
        \item 两个非零向量 $\bm{\alpha}, \bm{\beta}$ 正交时夹角为 $90^{\circ}$。
    \end{enumerate}
\end{definition}

\begin{remark}
    若 $\bm{\alpha}$ 与 $\bm{\beta}$ 正交，则 $\langle \bm{\alpha}, \bm{\beta} \rangle = \langle \bm{\beta}, \bm{\alpha} \rangle = 0$，于是有推广的勾股定理
    \[
        {\Vert \bm{\alpha} + \bm{\beta} \Vert}^{2} = {\Vert \bm{\alpha} \Vert}^{2} + {\Vert \bm{\beta} \Vert}^{2}
    \]
\end{remark}

\begin{remark}
    设 $V$ 是 $n$ 维实行向量空间，内积取标准内积，则得 Cauchy 不等式
    \[
        (x_{1}y_{1} + x_{2}y_{2} + \cdots + x_{n}y_{n})^{2} \leqslant  (x_{1}^{2} + x_{2}^{2} + \cdots + x_{n}^{2})(y_{1}^{2} + y_{2}^{2} + \cdots + y_{n}^{2})
    \]
\end{remark}

\begin{remark}
    设 $V$ 是由 $[a, b]$ 区间上的连续函数全体构成的实线性空间，内积定义为
    \[
        \langle f, g \rangle = \int_{a}^{b}f(t)g(t)\mathrm{d}t
    \]
    则得 Schuwarz 不等式
    \[
        \left(\int_{a}^{b}f(t)g(t)\mathrm{d}t\right)^{2} \leqslant \int_{a}^{b}f(t)^{2}\mathrm{d}t \int_{a}^{b}g(t)^{2}\mathrm{d}t
    \]
\end{remark}

\begin{definition}
    设 $V$ 是 $n$ 阶实矩阵空间，对任意的 $n$ 阶实矩阵 $\bm{A} = (a_{ij}), \bm{B} = (b_{ij})$，定义 $V$ 上的内积
    \[
        \langle \bm{A}, \bm{B} \rangle = \operatorname{tr}(\bm{AB}^{\mathrm{T}}) = \sum_{i = 1}^{n}\sum_{j = 1}^{n}a_{ij}b_{ij}
    \]
    设 $U$ 是 $n$ 阶复矩阵空间，对任意的 $n$ 阶复矩阵 $\bm{A} = (a_{ij}), \bm{B} = (b_{ij})$，定义 $U$ 上的内积
    \[
        \langle \bm{A}, \bm{B} \rangle = \operatorname{tr}(\bm{A}\overline{\bm{B}}^{\mathrm{T}}) = \sum_{i = 1}^{n}\sum_{j = 1}^{n}a_{ij}\overline{b_{ij}}
    \]
    两个内积统称为 Frobenius 内积。
\end{definition}

%——————————————————————————————————%

\section{内积的表示和正交基}

\begin{definition}
    设 $V$ 是欧式空间。$\{\bm{v}_1, \bm{v}_2, \ldots,\bm{v}_n\}$ 是 $V$ 的一组基。则 $V$ 的内积在给定基下的表示
    \[
        \langle \bm{\alpha}, \bm{\beta} \rangle = \bm{x}^{\mathrm{T}}\bm{Gy}
    \]
    其中 $\bm{x}, \bm{y}$ 分别是向量 $\bm{\alpha}, \bm{\beta}$ 在给定基下的坐标向量，$\bm{G}$ 是基向量的 Gram 矩阵或内积空间在给定基下的度量矩阵。
    \[
        \bm{G} = \begin{pmatrix}
            \langle \bm{v}_1, \bm{v}_1 \rangle & \langle \bm{v}_1, \bm{v}_2 \rangle & \cdots & \langle \bm{v}_1, \bm{v}_n \rangle   \\
            \langle \bm{v}_2, \bm{v}_1 \rangle & \langle \bm{v}_2, \bm{v}_2 \rangle & \cdots & \langle \bm{v}_2, \bm{v}_n \rangle   \\
            \vdots                             & \vdots                             & \      & \vdots                               \\
            \langle \bm{v}_n, \bm{v}_1 \rangle & \langle \bm{v}_n, \bm{v}_2 \rangle & \cdots & \langle \bm{v}_n, \bm{v}_n \rangle \
        \end{pmatrix}
    \]
    $\bm{G}$ 是一个正定实对称阵。
\end{definition}

\begin{definition}
    酉空间的内积在给定基下的表示
    \[
        \langle \bm{\alpha}, \bm{\beta} \rangle = \bm{x}^{\mathrm{T}}\bm{H}\overline{\bm{y}}
    \]
    其中 $\bm{x}, \bm{y}$ 分别是向量 $\bm{\alpha}, \bm{\beta}$ 在给定基下的坐标向量，$\bm{H}$ 是正定 Hermite 矩阵。
    \[
        \bm{H} = \begin{pmatrix}
            \langle \bm{v}_1, \bm{v}_1 \rangle & \langle \bm{v}_1, \bm{v}_2 \rangle & \cdots & \langle \bm{v}_1, \bm{v}_n \rangle   \\
            \langle \bm{v}_2, \bm{v}_1 \rangle & \langle \bm{v}_2, \bm{v}_2 \rangle & \cdots & \langle \bm{v}_2, \bm{v}_n \rangle   \\
            \vdots                             & \vdots                             & \      & \vdots                               \\
            \langle \bm{v}_n, \bm{v}_1 \rangle & \langle \bm{v}_n, \bm{v}_2 \rangle & \cdots & \langle \bm{v}_n, \bm{v}_n \rangle \
        \end{pmatrix}
    \]
\end{definition}

\begin{definition}
    设 $\{\bm{e}_{1}, \bm{e}_{2}, \ldots, \bm{e}_{n}\}$ 是 $n$ 维内积空间 $V$ 的一组基。若 $e_{i} \perp e_{j}$ 对一切 $i \neq j$ 成立，则称这组基是 $V$ 的一组正交基。又若 $V$ 的一组正交基中每个基向量的长度都等于 $1$，则称这组正交基为标准正交基。
\end{definition}

\begin{lemma}
    内积空间 $V$ 中的任意一组两两正交的非零向量必定线性无关。
\end{lemma}

\begin{lemma}
    设向量 $\bm{\alpha}$ 和 $\bm{\beta}_1, \bm{\beta}_2, \ldots, \bm{\beta}_k$ 都正交，则 $\bm{\alpha}$ 和 $L(\bm{\beta}_1, \bm{\beta}_2, \ldots, \bm{\beta}_k)$ 中的每个向量都正交。
\end{lemma}

\begin{corollary}
    $n$ 维内积空间中任意一个正交非零向量组的向量个数不超过 $n$。
\end{corollary}

\begin{theorem}{Gram-Schmidt 正交化方法}
    设 $V$ 是内积空间，$\bm{u}_1, \bm{u}_2, \ldots, \bm{u}_m$ 是 $V$ 中 $m$ 个线性无关的向量，则在 $V$ 中存在 $m$ 个两两正交的非零向量 $\bm{v}_1, \bm{v}_2, \ldots,\bm{v}_m$，使由 $\{\bm{v}_1, \bm{v}_2, \ldots,\bm{v}_m\}$ 张成的子空间恰好为由 $\{\bm{u}_1, \bm{u}_2, \ldots, \bm{u}_m\}$ 张成的子空间，即 $\{\bm{v}_1, \bm{v}_2, \ldots,\bm{v}_m\}$ 是该子空间的一组正交基。
\end{theorem}

\begin{corollary}
    任一有限维内积空间均有标准正交基。
\end{corollary}

\begin{definition}
    设 $V$ 是 $n$ 维内积空间，$U$ 是 $V$ 的子空间，令
    \[
        U^{\perp} = \{\bm{v} \in V : \langle \bm{v}, U \rangle = 0\}
    \]
    这里 $\langle \bm{v}, U \rangle = 0$ 表示对一切 $\bm{u} \in U$，均有 $\langle \bm{v}, \bm{u} \rangle = 0$。则 $U^{\perp}$ 是 $V$ 的子空间，称为 $U$ 的正交补空间。
\end{definition}

\begin{theorem}
    设 $V$ 是 $n$ 维内积空间，$U$ 是 $V$ 的子空间，则
    \begin{enumerate}
        \item $V = U \oplus U^{\perp}$；
        \item $U$ 的任一组标准正交基均可扩张为 $V$ 的一组标准正交基。
    \end{enumerate}
\end{theorem}

\begin{definition}
    设 $V$ 是 $n$ 维内积空间，$V_1, V_2, \ldots, V_n$ 是 $V$ 的子空间。若对 $\forall \bm{\alpha} \in V_i$ 和 $\forall \bm{\beta} \in V_j$ 均有 $\langle \bm{\alpha}, \bm{\beta} \rangle = 0$，则称子空间 $V_i$ 和 $V_j$ 正交。若 $V = V_1 + V_2 + \cdots + V_k$ 且 $V_i$ 两两正交，则称 $V$ 是 $V_1, V_2, \ldots, V_k$ 的正交和，记为
    \[
        V = V_1 \perp V_2 \perp \cdots \perp V_k
    \]
\end{definition}

\begin{lemma}
    正交和必定为直和，且任一 $V_i$ 与其余子空间的和正交。
\end{lemma}

\begin{definition}
    设 $V = V_1 \perp V_2 \perp \cdots \perp V_k$，定义 $V$ 上的线性变换 $\bm{E}_{i}(i = 1, 2, \ldots, k)$ 如下：若 $\bm{v} = \bm{v}_{1} + \cdots + \bm{v}_{i} + \cdots + \bm{v}_{k}(\bm{v}_{i} \in V_i)$，令 $\bm{E}_{i}(\bm{v}) = \bm{v}_{i}$。则 $\bm{E}_i$ 是 $V$ 上的线性变换，且满足
    \begin{gather*}
        \bm{E}_{i}^2 = \bm{E}_i \\
        \bm{E}_{i}\bm{E}_{j} = \bm{0}\, (i \neq j) \\
        \bm{E}_{1} + \bm{E}_{2} + \cdots + \bm{E}_{k} = \bm{I}_V
    \end{gather*}
    线性变换 $\bm{E}_i$ 称为 $V$ 到 $V_i$ 上的正交投影（简称投影）。
\end{definition}

\begin{proposition}
    设 $U$ 是内积空间 $V$ 的子空间，$V = U \perp U^{\perp}$。设 $\bm{E}$ 是 $V$ 到 $U$ 上的正交投影，则对 $\forall \bm{\alpha}, \bm{\beta} \in V$，有
    \[
        \langle \bm{E}(\bm{\alpha}), \bm{\beta} \rangle = \langle \bm{\alpha}, \bm{E}({\bm{\beta}}) \rangle
    \]
\end{proposition}

\begin{proposition}{Bessel 不等式}
    设 $\{\bm{v}_1, \bm{v}_2, \ldots,\bm{v}_m\}$ 是内积空间 $V$ 中的正交非零向量组，$\bm{y}$ 是 $V$ 中任一向量，则
    \[
        \sum_{k = 1}^{m}\frac{{\vert \langle \bm{y}, \bm{v}_k \rangle \vert}^2}{{\Vert \bm{v}_k \Vert}^2} \leqslant {\Vert \bm{y} \Vert}^2
    \]
    且等号成立的充分必要条件是 $\bm{y}$ 属于由 $\{\bm{v}_1, \bm{v}_2, \ldots,\bm{v}_m\}$ 张成的子空间。
\end{proposition}

%——————————————————————————————————%

\section{伴随}

内积空间上的线性变换通常称为线性算子。

\begin{definition}
    设 $\varphi$ 是内积空间 $V$ 上的线性算子。若存在 $V$ 上的线性算子 $\varphi^*$，使等式
    \[
        \langle \varphi(\bm{\alpha}), \bm{\beta} \rangle = \langle \bm{\alpha}, \varphi^{*}(\bm{\beta}) \rangle
    \]
    对一切 $\bm{\alpha}, \bm{\beta} \in V$ 成立，则称 $\varphi^*$ 是 $\varphi$ 的伴随算子，简称为 $\varphi$ 的伴随。
\end{definition}

\begin{theorem}
    设 $V$ 是 $n$ 维内积空间，$\varphi$ 是 $V$ 上的线性变换，则存在 $V$ 上唯一的线性变换 $\varphi^*$ 使对一切 $\bm{\alpha}, \bm{\beta} \in V$，有
    \[
        \langle \varphi(\bm{\alpha}), \bm{\beta} \rangle = \langle \bm{\alpha}, \varphi^{*}(\bm{\beta}) \rangle
    \]
\end{theorem}

\begin{theorem}
    设 $V$ 是 $n$ 维内积空间，$\{\bm{e}_{1}, \bm{e}_{2}, \ldots, \bm{e}_{n}\}$ 是 $V$ 的一组标准正交基。若 $V$ 上的线性算子 $\varphi$ 在这组基下的表示矩阵为 $\bm{A}$，则当 $V$ 是酉空间时，$\varphi^*$ 在同一组基下的表示矩阵为 $\overline{\bm{A}}^{\mathrm{T}}$，即 $\bm{A}$ 的共轭转置；当 $\bm{A}$ 是欧氏空间时，$\varphi^*$ 的表示矩阵为 $A^{\mathrm{T}}$，即 $\bm{A}$ 的转置。
\end{theorem}

\begin{theorem}
    设 $V$ 是有限维内积空间，若 $\varphi$ 及 $\psi$ 是 $V$ 上的线性变换，$c$ 为常数，则
    \begin{enumerate}
        \item $(\varphi + \psi)^* = \varphi^* + \psi^*$；
        \item $(c\varphi)^* = \overline{c}\varphi^*$；
        \item $(\varphi\psi)^* = \psi^{*}\varphi^{*}$；
        \item $(\varphi^*)^* = \varphi$。
    \end{enumerate}
\end{theorem}

\begin{proposition}
    设 $V$ 是 $n$ 维内积空间，$\varphi$ 是 $V$ 上的线性算子。
    \begin{enumerate}
        \item 若 $U$ 是 $\varphi$ 的不变子空间，则 $U^{\perp}$ 是 $\varphi^*$ 的不变子空间；
        \item 若 $\varphi$ 的全体特征值为 $\lambda_1, \lambda_2, \ldots, \lambda_n$，则 $\varphi^*$ 的全体特征值为 $\overline{\lambda}_1, \overline{\lambda}_2, \ldots, \overline{\lambda}_n$。
    \end{enumerate}
\end{proposition}


%——————————————————————————————————%

\section{内积空间的同构、正交变换和酉变换}

\begin{definition}
    设 $V$ 与 $U$ 是域 $\mathbb{K}$ 上的内积空间，$\mathbb{K}$ 是实数域或复数域，$\varphi$ 是 $V \to U$ 的线性映射。若对 $\forall \bm{x}, \bm{y} \in V$，有
    \[
        \langle \varphi(\bm{x}), \varphi(\bm{y}) \rangle = \langle \bm{x}, \bm{y} \rangle
    \]
    则称 $\varphi$ 是 $V \to U$ 的保持内积的线性映射。又若 $\varphi$ 作为线性映射是同构，则称 $\varphi$ 是内积空间 $V$ 到 $U$ 的保积同构。
\end{definition}

\begin{remark}
    在不引起误解的情况下，保积同构简称为同构。
\end{remark}

\begin{remark}
    保持内积的线性映射一定是单射。
\end{remark}

\begin{remark}
    保积同构是等价关系。
\end{remark}

\begin{proposition}
    若 $\varphi$ 是内积空间 $V$ 到内积空间 $U$ 的保持范数的线性映射，则 $\varphi$ 保持内积。
\end{proposition}

\begin{theorem}
    设 $V$ 和 $U$ 同时是 $n$ 维实或复的内积空间，若 $\varphi$ 是 $V \to U$ 的线性映射，则下列命题等价：
    \begin{enumerate}
        \item $\varphi$ 保持内积；
        \item $\varphi$ 是保积同构；
        \item $\varphi$ 将 $V$ 的任一组标准正交基变成 $U$ 的一组标准正交基；
        \item $\varphi$ 将 $V$ 的某一组标准正交基变成 $U$ 的一组标准正交基。
    \end{enumerate}
\end{theorem}

\begin{corollary}
    两个同时是实或复的有限维内积空间 $V$ 与 $U$ 同构的充分必要条件是它们有相同的维数。
\end{corollary}

\begin{definition}
    设 $\varphi$ 是内积空间 $V$ 上保持内积的线性变换，若 $V$ 是欧式空间，则称 $\varphi$ 为正交变换或正交算子；若 $V$ 是酉空间，则称 $\varphi$ 为酉变换或酉算子。
\end{definition}

\begin{remark}
    正交变换和酉变换都是可逆线性变换。
\end{remark}

\begin{theorem}
    设 $\varphi$ 是欧式空间或酉空间上的线性变换，则 $\varphi$ 是正交变换或酉变换的充分必要条件是 $\varphi$ 可逆，且
    \[
        \varphi^{*} = \varphi^{-1}
    \]
\end{theorem}

\begin{definition}
    设 $\bm{A}$ 是 $n$ 阶实方阵，若 $\bm{A}^{\mathrm{T}} = \bm{A}^{-1}$，则称 $\bm{A}$ 是正交矩阵。设 $\bm{C}$ 是 $n$ 阶复方阵，若 $\overline{\bm{C}}^{\mathrm{T}} = \bm{C}^{-1}$，则称 $\bm{C}$ 是酉矩阵。
\end{definition}

\begin{theorem}
    设 $\varphi$ 是欧氏空间（酉空间）$V$ 上的正交变换（酉变换），则在 $V$ 上的任一组标准正交基下，$\varphi$ 的表示矩阵是正交矩阵（酉矩阵）。
\end{theorem}

\begin{theorem}
    设 $\bm{A} = (a_{ij})$ 是 $n$ 阶实矩阵，则 $\bm{A}$ 是正交矩阵的充分必要条件是：
    \begin{gather*}
        a_{i1}a_{j1} + a_{i2}a_{j2} + \cdots + a_{in}a_{jn} = 0, \quad (i \neq j) \\
        a_{i1}^{2} + a_{i2}^{2} + \cdots + a_{in}^{2} = 1
    \end{gather*}
    或
    \begin{gather*}
        a_{1i}a_{1j} + a_{2i}a_{2j} + \cdots + a_{ni}a_{nj} = 0, \quad (i \neq j) \\
        a_{1i}^{2} + a_{2i}^{2} + \cdots + a_{ni}^{2} = 1
    \end{gather*}
    即 $\bm{A}$ 为正交矩阵的充分必要条件是它的 $n$ 个行向量是 $n$ 维实行向量空间（取标准内积）的标准正交基，或它的 $n$ 个列向量是 $n$ 维实列向量空间（取标准内积）的标准正交基。
\end{theorem}

\begin{theorem}
    设 $\bm{A} = (a_{ij})$ 是 $n$ 阶复矩阵，则 $\bm{A}$ 是酉矩阵的充分必要条件是
    \begin{gather*}
        a_{i1}\overline{a}_{j1} + a_{i2}\overline{a}_{j2} + \cdots + a_{in}\overline{a}_{jn} = 0, \quad (i \neq j) \\
        {\vert a_{i1} \vert}^{2} + {\vert a_{i2} \vert}^{2} + \cdots + {\vert a_{in} \vert}^{2} = 1
    \end{gather*}
    或
    \begin{gather*}
        a_{1i}\overline{a}_{1j} + a_{2i}\overline{a}_{2j} + \cdots + a_{ni}\overline{a}_{nj} = 0, \quad (i \neq j) \\
        {\vert a_{1i} \vert}^{2} + {\vert a_{2i} \vert}^{2} + \cdots + {\vert a_{ni} \vert}^{2} = 1
    \end{gather*}
    即 $\bm{A}$ 为酉矩阵的充分必要条件是它的 $n$ 个行向量是 $n$ 维复行向量空间（取标准内积）的标准正交基，或它的 $n$ 个列向量是 $n$ 维复列向量空间（取标准内积）的标准正交基。
\end{theorem}

\begin{theorem}
    若 $n$ 阶实矩阵 $\bm{A}$ 是正交矩阵，则
    \begin{enumerate}
        \item $\bm{A}$ 的行列式值等于 $1$ 或 $-1$；
        \item $\bm{A}$ 的特征值的模长等于 $1$。
    \end{enumerate}
\end{theorem}

\begin{theorem}
    若 $n$ 阶复矩阵 $\bm{A}$ 是酉矩阵，则
    \begin{enumerate}
        \item $\bm{A}$ 的行列式值的模长等于 $1$；
        \item $\bm{A}$ 的特征值的模长等于 $1$。
    \end{enumerate}
\end{theorem}

\begin{theorem}
    设 $\bm{A}$ 是 $n$ 阶实（复）矩阵，则 $\bm{A}$ 可分解为
    \[
        \bm{A} = \bm{QR}
    \]
    其中 $\bm{Q}$ 是正交（酉）矩阵，$\bm{R}$ 是主对角线上的元素大于等于零的上三角阵，并且若 $\bm{A}$ 是可逆阵，则这样的分解唯一。
\end{theorem}


%——————————————————————————————————%

\section{自伴随算子}

\begin{lemma}
    欧氏空间中两组标准正交基之间的过渡矩阵是正交矩阵，酉空间中量子标准正交基之间的过渡矩阵是酉矩阵。
\end{lemma}

\begin{definition}
    设 $\bm{A}, \bm{B}$ 是 $n$ 阶实矩阵。若存在正交矩阵 $\bm{P}$，使 $\bm{B} = \bm{P}^{\mathrm{T}}\bm{AP}$，则称 $\bm{B}$ 和 $\bm{A}$ 正交相似。
    设 $\bm{A}, \bm{B}$ 是 $n$ 阶复矩阵。若存在酉矩阵 $\bm{P}$，使 $\bm{B} = \overline{\bm{P}}^{\mathrm{T}}\bm{AP}$，则称 $\bm{B}$ 和 $\bm{A}$ 酉相似。
\end{definition}

\begin{remark}
    正交（酉）相似是等价关系。
\end{remark}

\begin{definition}
    设 $\varphi$ 是内积空间 $V$ 上的线性变换，$\varphi^*$ 是 $\varphi$ 的伴随。若 $\varphi^* = \varphi$，则称 $\varphi$ 是自伴随算子。当 $V$ 是欧式空间时，$\varphi$ 也称为对称算子或对称变换；当 $V$ 是酉空间时，$\varepsilon$ 也称为 Hermite 算子或 Hermite 变换。
\end{definition}

\begin{theorem}
    设 $V$ 是 $n$ 维酉空间，$\varphi$ 是 $V$ 上的自伴随算子，则 $\varphi$ 的特征值全是实数且属于不同特征值的特征向量互相正交。
\end{theorem}

\begin{corollary}
    Hermite 矩阵的特征值全是实数，实对称阵的特征值也全是实数。这两种矩阵属于不同特征值的特征向量互相正交。
\end{corollary}

\begin{theorem}
    设 $V$ 是 $n$ 维内积空间，$\varphi$ 是 $V$ 上的自伴随算子，则存在 $V$ 的一组正交基，使 $\varphi$ 在这组基下的表示矩阵为实对角阵，且这组基恰好是 $\varphi$ 的 $n$ 个线性无关的特征向量。
\end{theorem}

\begin{theorem}
    \begin{enumerate}
        \item 设 $\bm{A}$ 是 $n$ 阶实对称阵，则存在正交矩阵 $\bm{P}$，使 $\bm{P}^{\mathrm{T}}\bm{AP}$ 为对角阵，且 $\bm{P}$ 的 $n$ 个列向量恰好为 $\bm{A}$ 的 $n$ 个两两正交的单位特征向量。
        \item 设 $\bm{A}$ 是 $n$ 阶 Hermite 矩阵，则存在酉矩阵 $\bm{P}$，使 $\overline{\bm{P}}^{\mathrm{T}}\bm{AP}$ 为对角阵，且 $\bm{P}$ 的 $n$ 个列向量恰好为 $\bm{A}$ 的 $n$ 个两两正交的单位特征向量。
    \end{enumerate}
\end{theorem}

\begin{corollary}
    实对称阵的全体特征值是实对称阵在正交相似关系下的全系部变量，Hermite 矩阵的全体特征值是 Hermite 矩阵在酉相似关系下的全系部变量。
\end{corollary}

\begin{theorem}
    设 $f(x) = \bm{x}^{\mathrm{T}}\bm{Ax}$ 是 $n$ 元实二次型，系数矩阵 $\bm{A}$ 的特征值为 $\lambda_1, \lambda_2, \ldots, \lambda_n$，则 $f$ 经过正交变换 $\bm{x} = \bm{Py}$ 可以化为下列标准型
    \[
        \lambda_{1}y_{1}^{2} + \lambda_{2}y_{2}^{2} + \cdots + \lambda_{n}y_{n}^{2}
    \]
    因此 $f$ 的正惯性指数等于 $\bm{A}$ 的正特征值个数，负惯性指数等于 $\bm{A}$ 的负特征值个数，$f$ 的秩等于 $\bm{A}$ 的非零特征值的个数。
\end{theorem}

\begin{corollary}
    设 $f(x) = \bm{x}^{\mathrm{T}}\bm{Ax}$ 是 $n$ 元实二次型，则
    \begin{enumerate}
        \item $f$ 是正定型当且仅当系数矩阵 $\bm{A}$ 的特征值全是正数；
        \item $f$ 是负定型当且仅当 $\bm{A}$ 的特征值全是负数；
        \item $f$ 是半正定型当且仅当 $\bm{A}$ 的特征值全是非负数；
        \item $f$ 是半负定型当且仅当 $\bm{A}$ 的特征值全是非正数；
    \end{enumerate}

\end{corollary}

%——————————————————————————————————%

\section{复正规算子}

\begin{definition}
    设 $\varphi$ 是内积空间 $V$ 上的线性变换，$\varphi^*$ 是其伴随。若 $\varphi\varphi^* = \varphi^*\varphi$，则称 $\varphi$ 是 $V$ 上的正规算子（欧式空间上的称为实正规算子，酉空间上的称为复正规算子）。复矩阵 $\bm{A}$ 若满足 $\overline{\bm{A}}^{\mathrm{T}}\bm{A} = \bm{A}\overline{\bm{A}}^{\mathrm{T}}$，则称 $\bm{A}$ 为复正规矩阵。实矩阵 $\bm{A}$ 若满足 $\bm{A}^{\mathrm{T}}\bm{A} = \bm{AA}^{\mathrm{T}}$，则称 $\bm{A}$ 为实正规矩阵。
\end{definition}

\begin{lemma}
    设 $\varphi$ 是内积空间 $V$ 上的正规算子，则对 $\forall \alpha \in V$，有
    \[
        \Vert \varphi(\alpha) \Vert = \Vert \varphi^*(\alpha) \Vert
    \]
\end{lemma}

\begin{proposition}
    设 $V$ 是 $n$ 维酉空间，$\varphi $ 是 $V$ 上的正规算子。
    \begin{enumerate}
        \item 向量 $\bm{u}$ 是 $\varphi$ 属于特征值 $\lambda$ 的特征向量的充分必要条件为 $\bm{u}$ 是 $\varphi^*$ 属于特征值 $\overline{\lambda}$ 的特征向量；
        \item 属于 $\varphi$ 的不同特征值的特征向量必定正交。
    \end{enumerate}
\end{proposition}

\begin{lemma}
    设 $V$ 是 $n$ 维酉空间，$\varphi $ 是 $V$ 上的线性变换，$\{\bm{e}_{1}, \bm{e}_{2}, \ldots, \bm{e}_{n}\}$ 是 $V$ 的一组标准正交基。又设 $\varphi$ 在这组基下的表示矩阵 $\bm{A}$ 为上三角阵，则 $\varphi$ 是正规算子的充分必要条件为 $\bm{A}$ 是对角阵。
\end{lemma}

\begin{theorem}{Schur 定理}
    设 $V$ 是 $n$ 维酉空间，$\varphi $ 是 $V$ 上的线性算子，则存在 $V$ 的一组标准正交基，使得 $\varphi$ 在这组基下的表示矩阵为上三角阵。
\end{theorem}

\begin{corollary}{Schur 定理}
    任一 $n$ 阶复矩阵均酉相似于一个上三角阵。
\end{corollary}

\begin{theorem}
    设 $V$ 是 $n$ 维酉空间，$\varphi $ 是 $V$ 上的线性算子，则 $\varphi$ 为正规算子的充分必要条件是存在 $V$ 的一组标准正交基，使得 $\varphi$ 在这组基下的表示矩阵是对角阵。特别地，这组基下恰好是 $\varphi$ 的 $n$ 个线性无关的特征向量。
\end{theorem}

\begin{theorem}
    复矩阵 $\bm{A}$ 为复正规矩阵的充分必要条件是 $\bm{A}$ 酉相似于对角阵。
\end{theorem}

\begin{proposition}
    设 $\varphi$ 是 $n$ 维酉空间 $V$ 上的线性算子，$\lambda_1, \lambda_2, \ldots, \lambda_k$ 是 $\varphi$ 的全体不同特征值，$V_1, V_2, \ldots, V_k$ 是对应的特征子空间，则 $\varphi$ 是正规算子的充分必要条件为
    \[
        V = V_1 \perp V_2 \perp \cdots \perp V_k
    \]
\end{proposition}

\begin{theorem}
    任一 $n$ 阶酉矩阵必定酉相似于下列对角阵
    \[
        \operatorname{diag}\{c_1, c_2, \ldots, c_n\}
    \]
    其中 $c_i$ 为模长等于 $1$ 的复数。
\end{theorem}
%——————————————————————————————————%
\section{实正规矩阵}

\begin{lemma}
    设 $V$ 是 $n$ 维欧氏空间，$f(x)$ 是实系数多项式。若 $\varphi$ 是 $V$ 上的正规算子，则 $f(\varphi)$ 也是 $V$ 上的正规算子。
\end{lemma}

\begin{lemma}
    设 $\varphi$ 是欧式空间 $V$ 上的正规算子，$f(x)$ 和 $g(x)$ 是互素的实系数多项式。假设 $\bm{u} \in \ker(f(\varphi)), \bm{v} \in \ker(g(\varphi))$，则
    \[
        \langle \bm{u}, \bm{v} \rangle = 0
    \]
\end{lemma}

\begin{theorem}
    设 $V$ 是 $n$ 维欧式空间，$\varphi$ 是 $V$ 上的正规算子。令 $g(x)$ 是 $\varphi$ 的极小多项式，$g_1(x), g_2(x), \ldots, g_k(x)$ 是 $g(x)$ 的所有互不相同的首一不可约因式，且 $W_i = \ker(g_i(\varphi))(i = 1, 2, \ldots, k)$，则
    \begin{enumerate}
        \item $g(x) = g_1(x)\cdots g_k(x)$，其中 $\deg g_i(x) \leqslant 2$；
        \item $V = W_1 \perp \cdots \perp W_k$；
        \item $W_i$ 是 $\varphi$ 的不变子空间。用 $\varphi_i$ 表示 $\varphi$ 在 $W_i$ 上的限制，则 $\varphi_i$ 是 $W_i$ 上的正规算子且 $g_i(x)$ 是 $\varphi$ 的极小多项式。
    \end{enumerate}
\end{theorem}

\begin{lemma}
    设 $V$ 是 $n$ 维欧式空间，$\varphi$ 是 $V$ 上的正规算子且 $\varphi$ 满足多项式 $g(x) = x^2 + 1$。设 $\bm{v} \in V, \bm{u} = \varphi(\bm{v})$，则
    \[
        \varphi^*(\bm{v}) = -\bm{u},\quad \varphi^*(\bm{u}) = \bm{v}
    \]
    且 $\Vert \bm{u} \Vert = \Vert \bm{v} \Vert, \bm{u} \perp \bm{v}$。
\end{lemma}

\begin{lemma}
    设 $V$ 是 $n$ 维欧式空间，$\varphi$ 是 $V$ 上的正规算子且 $\varphi$ 满足多项式 $g(x) = (x - a)^2 + b^2$，其中 $a, b \in \mathbb{R}$ 且 $b \neq 0$。设 $\bm{v} \in V, \bm{u} = b^{-1}(\varphi - a \bm{I})(\bm{v})$，则 $\Vert \bm{u} \Vert = \Vert \bm{v} \Vert, \bm{u} \perp \bm{v}$，且
    \begin{gather*}
        \varphi(\bm{v}) = a \bm{v} + b \bm{u}, \quad \varphi(\bm{u}) = -b \bm{v} + a \bm{u} \\
        \varphi^*(\bm{v}) = a \bm{v} - b \bm{u}, \quad \varphi^*(\bm{u}) = b \bm{v} + a \bm{u}
    \end{gather*}
\end{lemma}

\begin{theorem}
    设 $\varphi$ 是 $n$ 维欧式空间 $V$ 上的正规算子，$\varphi$ 的极小多项式为 $g(x) = (x - a)^2 + b^2$，其中 $a, b \in \mathbb{R}$ 且 $b \neq 0$，则存在 $V$ 的 $s$ 个二维子空间 $V_1, V_2, \ldots, V_s$ 使
    \[
        V = V_1 \perp V_2 \perp \cdots \perp V_s
    \]
    且每个 $V_i$ 都有标准正交基 $\{\bm{u}_i, \bm{v}_i\}$，满足
    \[
        \varphi(\bm{u}_i) = a \bm{u}_i - b \bm{v}_i, \quad \varphi(\bm{v}_i) = b \bm{u}_i + a \bm{v}_i
    \]
\end{theorem}

\begin{theorem}
    设 $V$ 是 $n$ 维欧式空间，$\varphi$ 是 $V$ 上的正规算子，则存在一组标准正交基，使 $\varphi$ 在这组基下的表示矩阵为下列分块对角阵：
    \[
        \operatorname{diag}\{\bm{A}_1, \ldots, \bm{A}_r, c_{2r + 1}, \ldots, c_n\}
    \]
    其中 $c_{j}(j = 2r + 1, \ldots, n)$ 是实数，$\bm{A}_i$ 是形如
    \[
        \begin{pmatrix}
            a_i  & b_i \\
            -b_i & a_i
        \end{pmatrix}
    \]
    的二阶实矩阵。
\end{theorem}

\begin{theorem}
    设 $\bm{A}$ 是 $n$ 阶正交矩阵，则 $\bm{A}$ 正交相似于下列分块对角阵：
    \[
        \operatorname{diag}\{\bm{A}_1, \ldots, \bm{A}_r; 1, \ldots, 1; -1, \ldots, -1\}
    \]
    其中
    \[
        \bm{A}_i = \begin{pmatrix}
            \cos \theta_i  & \sin \theta_i \\
            -\sin \theta_i & \cos \theta_i
        \end{pmatrix}, i = 1, 2, \ldots, r
    \]
\end{theorem}

\begin{theorem}
    设 $\bm{A}$ 是实反对称阵，则 $\bm{A}$ 正交相似于下列分块对角阵：
    \[
        \operatorname{diag}\{\bm{B}_1, \ldots, \bm{B}_r; 0, \ldots, 0\}
    \]
    其中
    \[
        \bm{B}_i = \begin{pmatrix}
            0    & b_i \\
            -b_i & 0
        \end{pmatrix}, i = 1, 2, \ldots, r
    \]
\end{theorem}

\begin{corollary}
    实反对称阵的秩必是偶数，且其实特征值为 $0$，虚特征值为纯虚数
\end{corollary}

%——————————————————————————————————%